/**
 * –ü–∞—Ä—Å–µ—Ä –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã MIXIT
 * –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç 156 –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π –≤ 12 –∫—Ä—É–ø–Ω—ã—Ö –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤
 * 
 * –ó–∞–ø—É—Å–∫: node scripts/parse-org-structure.js
 */

const xlsx = require('xlsx');
const fs = require('fs');
const path = require('path');

// –ü—É—Ç—å –∫ Excel —Ñ–∞–π–ª—É
const EXCEL_PATH = '/Users/konstantin/Documents/Mixit  MSK/Profit optimizer/–æ—Ä–≥—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ 544 —á–µ–ª–æ–≤–µ–∫–∞.xls';
const OUTPUT_PATH = path.join(__dirname, '../src/data/org-structure.json');

// –ú–∞–ø–ø–∏–Ω–≥ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π ‚Üí –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã
const DEPARTMENT_MAPPING = {
    // E-COM: –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ã
    'WILDBERRIES': { dept: 'E-COM WB', icon: 'üü£' },
    'WILDBERRIES –õ–∏—Ü–æ': { dept: 'E-COM WB', icon: 'üü£' },
    'WILDBERRIES –¢–µ–ª–æ': { dept: 'E-COM WB', icon: 'üü£' },
    'WILDBERRIES Make Up': { dept: 'E-COM WB', icon: 'üü£' },
    'WILDBERRIES –í–æ–ª–æ—Å—ã': { dept: 'E-COM WB', icon: 'üü£' },
    'WILDBERRIES Sammy Beauty': { dept: 'E-COM WB', icon: 'üü£' },
    'WILDBERRIES –ë–ê–î—ã': { dept: 'E-COM WB', icon: 'üü£' },
    'WILDBERRIES –ë—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è': { dept: 'E-COM WB', icon: 'üü£' },

    'OZON': { dept: 'E-COM OZON', icon: 'üü†' },
    'OZON –õ–ò–¶–û': { dept: 'E-COM OZON', icon: 'üü†' },
    'OZON –¢–ï–õ–û': { dept: 'E-COM OZON', icon: 'üü†' },
    'OZON –ú–ê–ö–ò–Ø–ñ': { dept: 'E-COM OZON', icon: 'üü†' },
    'OZON –í–û–õ–û–°–´': { dept: 'E-COM OZON', icon: 'üü†' },
    'OZON –ë–ê–î–´': { dept: 'E-COM OZON', icon: 'üü†' },
    'OZON –ë–´–¢–û–í–ê–Ø –•–ò–ú–ò–Ø': { dept: 'E-COM OZON', icon: 'üü†' },
    'OZON Sammy Beauty': { dept: 'E-COM OZON', icon: 'üü†' },

    '–Ø–ù–î–ï–ö–°': { dept: 'E-COM –Ø–Ω–¥–µ–∫—Å', icon: 'üî¥' },

    '–û—Ç–¥–µ–ª –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤': { dept: 'E-COM –ü–æ–¥–¥–µ—Ä–∂–∫–∞', icon: 'üõí' },
    '–û—Ç–¥–µ–ª –ò–ò-–¥–∏–∑–∞–π–Ω–∞ –Ω–∞ –ú–ü': { dept: 'E-COM –ü–æ–¥–¥–µ—Ä–∂–∫–∞', icon: 'üõí' },
    '–û—Ç–¥–µ–ª –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ –ú–ü': { dept: 'E-COM –ü–æ–¥–¥–µ—Ä–∂–∫–∞', icon: 'üõí' },

    // –û—Ñ—Ñ–ª–∞–π–Ω –ø—Ä–æ–¥–∞–∂–∏
    'FMCG': { dept: '–û—Ñ—Ñ–ª–∞–π–Ω –ø—Ä–æ–¥–∞–∂–∏', icon: 'üè™' },
    '–û—Ñ—Ñ–ª–∞–π–Ω –ø—Ä–æ–¥–∞–∂–∏': { dept: '–û—Ñ—Ñ–ª–∞–π–Ω –ø—Ä–æ–¥–∞–∂–∏', icon: 'üè™' },
    '–ê–ø—Ç–µ–∫–∏': { dept: '–û—Ñ—Ñ–ª–∞–π–Ω –ø—Ä–æ–¥–∞–∂–∏', icon: 'üè™' },
    'Beauty': { dept: '–û—Ñ—Ñ–ª–∞–π–Ω –ø—Ä–æ–¥–∞–∂–∏', icon: 'üè™' },
    '–ì—Ä—É–ø–ø–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å–µ—Ç–µ–π': { dept: '–û—Ñ—Ñ–ª–∞–π–Ω –ø—Ä–æ–¥–∞–∂–∏', icon: 'üè™' },
    '–û—Ç–¥–µ–ª —Å–µ—Ä–≤–∏—Å–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å–µ—Ç–µ–π': { dept: '–û—Ñ—Ñ–ª–∞–π–Ω –ø—Ä–æ–¥–∞–∂–∏', icon: 'üè™' },
    '–¢—Ä–µ–π–¥ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥': { dept: '–û—Ñ—Ñ–ª–∞–π–Ω –ø—Ä–æ–¥–∞–∂–∏', icon: 'üè™' },

    // –§–∏–Ω–∞–Ω—Å—ã
    '–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è': { dept: '–§–∏–Ω–∞–Ω—Å—ã', icon: 'üí∞' },
    '–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç': { dept: '–§–∏–Ω–∞–Ω—Å—ã', icon: 'üí∞' },
    '–ì—Ä—É–ø–ø–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –∏ –ö–∞–∑–Ω–∞—á–µ–π—Å—Ç–≤–∞': { dept: '–§–∏–Ω–∞–Ω—Å—ã', icon: 'üí∞' },
    '–ü–ª–∞–Ω–æ–≤–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –æ—Ç–¥–µ–ª': { dept: '–§–∏–Ω–∞–Ω—Å—ã', icon: 'üí∞' },
    '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞': { dept: '–§–∏–Ω–∞–Ω—Å—ã', icon: 'üí∞' },
    '–ì—Ä—É–ø–ø–∞ —Ç–æ–≤–∞—Ä–Ω–æ–≥–æ —É—á–µ—Ç–∞': { dept: '–§–∏–Ω–∞–Ω—Å—ã', icon: 'üí∞' },
    '–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ-—Ä–µ–≤–∏–∑–∏–æ–Ω–Ω–∞—è –≥—Ä—É–ø–ø–∞': { dept: '–§–∏–Ω–∞–Ω—Å—ã', icon: 'üí∞' },

    // –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ
    '–ü–†–û–ò–ó–í–û–î–°–¢–í–û –ï–°–ò–ü–û–í–û': { dept: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon: 'üè≠' },
    '–ü–†–û–ò–ó–í–û–î–°–¢–í–û –ê–ü–†–ï–õ–ï–í–ö–ê': { dept: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon: 'üè≠' },
    '–û—Ç–¥–µ–ª–µ–Ω–∏–µ —Ñ–∞—Å–æ–≤–∫–∏': { dept: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon: 'üè≠' },
    '–û—Ç–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è (–í–∞—Ä–∫–∏)': { dept: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon: 'üè≠' },
    '–û—Ç–¥–µ–ª–µ–Ω–∏–µ –≤–∞—Ä–∫–∏': { dept: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon: 'üè≠' },
    '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –ü–°–ö –ï—Å–∏–ø–æ–≤–æ': { dept: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon: 'üè≠' },
    '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –ü–ö –ê–ø—Ä–µ–ª–µ–≤–∫–∞': { dept: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon: 'üè≠' },
    '–û—Ç–¥–µ–ª —Ä–∞–∑–≤–µ—Å–∫–∏': { dept: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon: 'üè≠' },
    '–û—Ç–¥–µ–ª –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞': { dept: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon: 'üè≠' },
    '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –æ—Ç–¥–µ–ª': { dept: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon: 'üè≠' },
    '–ú–µ—Ö–∞–Ω–∏–∫–æ-–∏–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è —Å–ª—É–∂–±–∞': { dept: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon: 'üè≠' },
    '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ': { dept: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon: 'üè≠' },
    '–°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø—Ä–æ-–≤–æ': { dept: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon: 'üè≠' },
    '–ù–∞—á–∞–ª—å–Ω–∏–∫–∏ —Å–º–µ–Ω': { dept: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', icon: 'üè≠' },

    // R&D
    '–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è': { dept: 'R&D', icon: 'üî¨' },
    '–û—Ç–¥–µ–ª –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤': { dept: 'R&D', icon: 'üî¨' },
    '–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è': { dept: 'R&D', icon: 'üî¨' },
    '–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è': { dept: 'R&D', icon: 'üî¨' },
    '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –†–¶ –ï—Å–∏–ø–æ–≤–æ': { dept: 'R&D', icon: 'üî¨' },

    // –õ–æ–≥–∏—Å—Ç–∏–∫–∞
    '–°–∫–ª–∞–¥': { dept: '–õ–æ–≥–∏—Å—Ç–∏–∫–∞', icon: 'üì¶' },
    '–õ–æ–≥–∏—Å—Ç–∏–∫–∞': { dept: '–õ–æ–≥–∏—Å—Ç–∏–∫–∞', icon: 'üì¶' },
    '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –ª–æ–≥–∏—Å—Ç–∏–∫–∞': { dept: '–õ–æ–≥–∏—Å—Ç–∏–∫–∞', icon: 'üì¶' },
    '–û—Ç–¥–µ–ª —Å–∫–ª–∞–¥—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π': { dept: '–õ–æ–≥–∏—Å—Ç–∏–∫–∞', icon: 'üì¶' },
    '–û—Ç–¥–µ–ª —Å–∫–ª–∞–¥—Å–∫–æ–≥–æ —É—á–µ—Ç–∞': { dept: '–õ–æ–≥–∏—Å—Ç–∏–∫–∞', icon: 'üì¶' },
    '–û—Ç–¥–µ–ª –≤–Ω–µ—à–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π': { dept: '–õ–æ–≥–∏—Å—Ç–∏–∫–∞', icon: 'üì¶' },
    '–†–¶': { dept: '–õ–æ–≥–∏—Å—Ç–∏–∫–∞', icon: 'üì¶' },
    '–ì–æ—Ç–æ–≤–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è': { dept: '–õ–æ–≥–∏—Å—Ç–∏–∫–∞', icon: 'üì¶' },

    // –ó–∞–∫—É–ø–∫–∏
    '–û—Ç–¥–µ–ª –∑–∞–∫—É–ø–æ–∫': { dept: '–ó–∞–∫—É–ø–∫–∏', icon: 'üõçÔ∏è' },
    '–û—Ç–¥–µ–ª –∑–∞–∫—É–ø–æ–∫, –°—ã—Ä—å–µ': { dept: '–ó–∞–∫—É–ø–∫–∏', icon: 'üõçÔ∏è' },
    '–û—Ç–¥–µ–ª –∑–∞–∫—É–ø–æ–∫, –¢–∞—Ä–∞': { dept: '–ó–∞–∫—É–ø–∫–∏', icon: 'üõçÔ∏è' },
    '–û—Ç–¥–µ–ª –∑–∞–∫—É–ø–æ–∫, –í–≠–î': { dept: '–ó–∞–∫—É–ø–∫–∏', icon: 'üõçÔ∏è' },
    '–û—Ç–¥–µ–ª –∑–∞–∫—É–ø–æ–∫, –ö–æ–Ω—Ç—Ä–∞–∫—Ç–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ': { dept: '–ó–∞–∫—É–ø–∫–∏', icon: 'üõçÔ∏è' },
    '–í–≠–î': { dept: '–ó–∞–∫—É–ø–∫–∏', icon: 'üõçÔ∏è' },
    '–°—ã—Ä—å–µ': { dept: '–ó–∞–∫—É–ø–∫–∏', icon: 'üõçÔ∏è' },
    '–¢–∞—Ä–∞': { dept: '–ó–∞–∫—É–ø–∫–∏', icon: 'üõçÔ∏è' },
    '–¢–∞—Ä–∞ –∏ –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ': { dept: '–ó–∞–∫—É–ø–∫–∏', icon: 'üõçÔ∏è' },
    '–ü–æ–ª–∏–≥—Ä–∞—Ñ–∏—è': { dept: '–ó–∞–∫—É–ø–∫–∏', icon: 'üõçÔ∏è' },
    '–ö–æ–Ω—Ç—Ä–∞–∫—Ç–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ': { dept: '–ó–∞–∫—É–ø–∫–∏', icon: 'üõçÔ∏è' },
    '–°–Ω–∞–±–∂–µ–Ω–∏–µ –ø–ª–æ—â–∞–¥–æ–∫': { dept: '–ó–∞–∫—É–ø–∫–∏', icon: 'üõçÔ∏è' },

    // IT
    '–û—Ç–¥–µ–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ 1–°': { dept: 'IT', icon: 'üíª' },
    '–û—Ç–¥–µ–ª –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ 1–°': { dept: 'IT', icon: 'üíª' },
    '–û–ø–µ—Ä–∞—Ç–æ—Ä—ã 1–°': { dept: 'IT', icon: 'üíª' },
    '–û—Ç–¥–µ–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ WMS': { dept: 'IT', icon: 'üíª' },
    '–û—Ç–¥–µ–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ DWH': { dept: 'IT', icon: 'üíª' },
    '–û—Ç–¥–µ–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º (DWH)': { dept: 'IT', icon: 'üíª' },
    '–û—Ç–¥–µ–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Bitrix24': { dept: 'IT', icon: 'üíª' },
    '–û—Ç–¥–µ–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ê–¢–û–ú': { dept: 'IT', icon: 'üíª' },
    '–û—Ç–¥–µ–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏': { dept: 'IT', icon: 'üíª' },
    '–û—Ç–¥–µ–ª —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è': { dept: 'IT', icon: 'üíª' },
    '–°–ª—É–∂–±–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–ï—Å–∏–ø–æ–≤–æ)': { dept: 'IT', icon: 'üíª' },
    '–°–ª—É–∂–±–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (1-—è –ª–∏–Ω–∏—è)': { dept: 'IT', icon: 'üíª' },
    '–û—Ç–¥–µ–ª —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏': { dept: 'IT', icon: 'üíª' },
    '–û—Ç–¥–µ–ª –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏–∑–∞': { dept: 'IT', icon: 'üíª' },
    '–û—Ç–¥–µ–ª –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏–∑–∞': { dept: 'IT', icon: 'üíª' },
    '–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç —Ü–∏—Ñ—Ä–æ–≤–æ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å–∞': { dept: 'IT', icon: 'üíª' },
    '–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤': { dept: 'IT', icon: 'üíª' },
    'AI HUB': { dept: 'IT', icon: 'üíª' },
    '–ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π AI': { dept: 'IT', icon: 'üíª' },
    '–û—Ç–¥–µ–ª –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã': { dept: 'IT', icon: 'üíª' },
    '–û—Ç–¥–µ–ª —Ä–µ—à–µ–Ω–∏–π –¶–û–î': { dept: 'IT', icon: 'üíª' },
    '–ü—Ä–æ–µ–∫—Ç–Ω—ã–π –æ—Ñ–∏—Å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã': { dept: 'IT', icon: 'üíª' },
    '–ì—Ä—É–ø–ø–∞ –ù–°–ò': { dept: 'IT', icon: 'üíª' },
    '–û—Ç–¥–µ–ª –ù–°–ò': { dept: 'IT', icon: 'üíª' },

    // –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥
    '–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞': { dept: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', icon: 'üé®' },
    'SMM –æ—Ç–¥–µ–ª': { dept: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', icon: 'üé®' },
    '–ö–æ–Ω—Ç–µ–Ω—Ç': { dept: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', icon: 'üé®' },
    '–û—Ç–¥–µ–ª –∫–æ–Ω—Ç–µ–Ω—Ç–∞': { dept: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', icon: 'üé®' },
    '–û—Ç–¥–µ–ª –∫–æ–ø–∏—Ä–∞–π—Ç–∏–Ω–≥–∞': { dept: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', icon: 'üé®' },
    '–û—Ç–¥–µ–ª –¥–∏–∑–∞–π–Ω–∞': { dept: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', icon: 'üé®' },
    '–û—Ç–¥–µ–ª —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞': { dept: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', icon: 'üé®' },
    '–û—Ç–¥–µ–ª –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞': { dept: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', icon: 'üé®' },
    '–û—Ç–¥–µ–ª 3D –¥–∏–∑–∞–π–Ω–∞': { dept: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', icon: 'üé®' },
    '–û—Ç–¥–µ–ª –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ —Ñ–æ—Ç–æ –∏ –≤–∏–¥–µ–æ–∫–æ–Ω—Ç–µ–Ω—Ç–∞': { dept: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', icon: 'üé®' },
    '–ë—Ä–µ–Ω–¥-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç': { dept: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', icon: 'üé®' },
    '–û—Ç–¥–µ–ª –ø–æ —Å–≤—è–∑—è–º —Å –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é': { dept: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', icon: 'üé®' },
    '–û—Ç–¥–µ–ª —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤': { dept: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', icon: 'üé®' },

    // Influence (–ë–ª–æ–≥–µ—Ä—ã)
    '–û—Ç–¥–µ–ª –ø–æ —Ä–∞–±–æ—Ç–µ —Å –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–º–∏ –±–ª–æ–≥–µ—Ä–∞–º–∏': { dept: 'Influence', icon: 'üì±' },
    '–û—Ç–¥–µ–ª –ø–æ —Ä–∞–±–æ—Ç–µ —Å –∫–∞—Ä–º–∞–Ω–Ω—ã–º–∏ –±–ª–æ–≥–µ—Ä–∞–º–∏': { dept: 'Influence', icon: 'üì±' },
    '–û—Ç–¥–µ–ª –ø–æ —Ä–∞–±–æ—Ç–µ —Å —Ä–∏–ª—Å–º–µ–π–∫–µ—Ä–∞–º–∏': { dept: 'Influence', icon: 'üì±' },
    'INFLUENCE –æ—Ç–¥–µ–ª': { dept: 'Influence', icon: 'üì±' },

    // HR
    'HR –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç': { dept: 'HR', icon: 'üë•' },
    'HR –æ—Ç–¥–µ–ª –ï—Å–∏–ø–æ–≤–æ': { dept: 'HR', icon: 'üë•' },
    '–û—Ç–¥–µ–ª –ø–æ–¥–±–æ—Ä–∞ –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞': { dept: 'HR', icon: 'üë•' },
    '–û—Ç–¥–µ–ª –∫–∞–¥—Ä–æ–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è': { dept: 'HR', icon: 'üë•' },
    '–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∏ –ª—å–≥–æ—Ç—ã': { dept: 'HR', icon: 'üë•' },
    '–ö–∞–π–¥–∑–µ–Ω + –æ–±—É—á–µ–Ω–∏–µ': { dept: 'HR', icon: 'üë•' },

    // –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π
    '–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç': { dept: '–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π', icon: '‚öñÔ∏è' },
    '–ì—Ä—É–ø–ø–∞ —Ç–µ–Ω–¥–µ—Ä–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è': { dept: '–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π', icon: '‚öñÔ∏è' },
    '–ì—Ä—É–ø–ø–∞ –ß–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫': { dept: '–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π', icon: '‚öñÔ∏è' },

    // –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π
    '–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç': { dept: '–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π', icon: '‚öôÔ∏è' },
    '–û—Ç–¥–µ–ª –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏': { dept: '–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π', icon: '‚öôÔ∏è' },
    '–û—Ç–¥–µ–ª –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤': { dept: '–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π', icon: '‚öôÔ∏è' },
    '–ü—Ä–æ–µ–∫—Ç–Ω—ã–π –æ—Ñ–∏—Å': { dept: '–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π', icon: '‚öôÔ∏è' },
    '–¶–µ–Ω—Ç—Ä –∑–∞–±–æ—Ç—ã –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö.': { dept: '–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π', icon: '‚öôÔ∏è' },
    '–ì—Ä—É–ø–ø–∞ –ø–æ —Ä–∞–±–æ—Ç–µ —Å —Ä–µ–∫–ª–∞–º–∞—Ü–∏—è–º–∏': { dept: '–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π', icon: '‚öôÔ∏è' },
    '–û—Ç–¥–µ–ª –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–¥–∞–∂': { dept: '–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π', icon: '‚öôÔ∏è' },
    '–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è': { dept: '–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π', icon: '‚öôÔ∏è' },

    // –î–∏—Ä–µ–∫—Ü–∏—è
    '–î–∏—Ä–µ–∫—Ü–∏—è': { dept: '–î–∏—Ä–µ–∫—Ü–∏—è', icon: 'üè¢' },
    '–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç': { dept: '–î–∏—Ä–µ–∫—Ü–∏—è', icon: 'üè¢' },
    '–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–∏—Ä–µ–∫—Ç–æ—Ä': { dept: '–î–∏—Ä–µ–∫—Ü–∏—è', icon: 'üè¢' },
    '–°–ë': { dept: '–î–∏—Ä–µ–∫—Ü–∏—è', icon: 'üè¢' },
    '–ê–•–û': { dept: '–î–∏—Ä–µ–∫—Ü–∏—è', icon: 'üè¢' },
    '–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –∏ –æ—Ö—Ä–∞–Ω–∞ —Ç—Ä—É–¥–∞': { dept: '–î–∏—Ä–µ–∫—Ü–∏—è', icon: 'üè¢' },
    '–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –ø–æ –∫–∞—á–µ—Å—Ç–≤—É': { dept: '–î–∏—Ä–µ–∫—Ü–∏—è', icon: 'üè¢' },
};

// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π –ø–æ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏
function isLeader(position) {
    if (!position) return false;
    const lowerPos = position.toLowerCase();
    return lowerPos.includes('–¥–∏—Ä–µ–∫—Ç–æ—Ä') ||
        lowerPos.includes('—Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å') ||
        lowerPos.includes('–Ω–∞—á–∞–ª—å–Ω–∏–∫') ||
        lowerPos.includes('head') ||
        lowerPos.includes('ceo') ||
        lowerPos.includes('cto') ||
        lowerPos.includes('cfo');
}

function getDepartment(unitName) {
    // –ü—Ä—è–º–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
    if (DEPARTMENT_MAPPING[unitName]) {
        return DEPARTMENT_MAPPING[unitName];
    }

    // –ü–æ–∏—Å–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é (–¥–ª—è –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–∏–ø–∞ "–î–∏—Ä–µ–∫—Ü–∏—è, –°–ë")
    const parts = unitName.split(',').map(s => s.trim());
    for (const part of parts) {
        if (DEPARTMENT_MAPPING[part]) {
            return DEPARTMENT_MAPPING[part];
        }
    }

    // –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
    const upperName = unitName.toUpperCase();
    if (upperName.includes('WILDBERRIES') || upperName.includes('WB')) {
        return { dept: 'E-COM WB', icon: 'üü£' };
    }
    if (upperName.includes('OZON')) {
        return { dept: 'E-COM OZON', icon: 'üü†' };
    }
    if (upperName.includes('MIXIT')) {
        return { dept: '–ë—Ä–µ–Ω–¥—ã', icon: 'üíÑ' };
    }

    // –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Äî –≤ "–ü—Ä–æ—á–µ–µ"
    return { dept: '–ü—Ä–æ—á–µ–µ', icon: 'üìã' };
}

function parseOrgStructure() {
    console.log('üìÇ –ß–∏—Ç–∞—é Excel —Ñ–∞–π–ª...');

    const workbook = xlsx.readFile(EXCEL_PATH);
    const sheetName = workbook.SheetNames[0];
    const worksheet = workbook.Sheets[sheetName];
    const rawData = xlsx.utils.sheet_to_json(worksheet, { header: 1 });

    console.log('üìã –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –¥–∞–Ω–Ω—ã–µ...');

    // –ú–∞–ø–ø–∏–Ω–≥ –∫–æ–ª–æ–Ω–æ–∫
    const COL_MAP = {
        fullName: 0,
        unit: 1,       // –ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ
        email: 2,
        phone: 3,
        firstName: 9,
        lastName: 10,
        position: 15,
        competencies: 22,
        canHelp: 26
    };

    const departments = new Map();
    const employees = [];

    // –ü–∞—Ä—Å–∏–º –¥–∞–Ω–Ω—ã–µ
    for (let i = 1; i < rawData.length; i++) {
        const row = rawData[i];

        if (!row[COL_MAP.fullName] || !row[COL_MAP.unit]) continue;

        const fullName = String(row[COL_MAP.fullName] || '').trim();
        const unitName = String(row[COL_MAP.unit] || '').trim();
        const position = String(row[COL_MAP.position] || '').trim();
        const email = String(row[COL_MAP.email] || '').trim();
        const phone = String(row[COL_MAP.phone] || '').trim();

        // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–ª—É–∂–µ–±–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã
        if (fullName.toLowerCase() === 'support') continue;

        const { dept: deptName, icon: deptIcon } = getDepartment(unitName);

        // –°–æ–∑–¥–∞—ë–º –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        if (!departments.has(deptName)) {
            departments.set(deptName, {
                id: `dept_${departments.size + 1}`,
                name: deptName,
                icon: deptIcon,
                units: new Map(),
                leaders: [],
                employeeCount: 0
            });
        }

        const dept = departments.get(deptName);

        // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ
        if (!dept.units.has(unitName)) {
            dept.units.set(unitName, {
                name: unitName,
                employees: []
            });
        }

        const employee = {
            id: `emp_${employees.length + 1}`,
            fullName,
            position,
            email,
            phone,
            unit: unitName,
            department: deptName,
            isLeader: isLeader(position)
        };

        employees.push(employee);
        dept.units.get(unitName).employees.push(employee.id);
        dept.employeeCount++;

        if (employee.isLeader) {
            dept.leaders.push({
                id: employee.id,
                name: fullName,
                position
            });
        }
    }

    // –§–æ—Ä–º–∏—Ä—É–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
    const orgStructure = {
        meta: {
            generatedAt: new Date().toISOString(),
            totalEmployees: employees.length,
            totalDepartments: departments.size,
            totalUnits: Array.from(departments.values()).reduce((acc, d) => acc + d.units.size, 0)
        },
        departments: Array.from(departments.values())
            .sort((a, b) => b.employeeCount - a.employeeCount)
            .map(dept => ({
                id: dept.id,
                name: dept.name,
                icon: dept.icon,
                employeeCount: dept.employeeCount,
                leaders: dept.leaders.slice(0, 3), // –¢–æ–ø-3 —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è
                units: Array.from(dept.units.values()).map(unit => ({
                    name: unit.name,
                    employeeCount: unit.employees.length,
                    employeeIds: unit.employees
                }))
            })),
        employees
    };

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º JSON
    const outputDir = path.dirname(OUTPUT_PATH);
    if (!fs.existsSync(outputDir)) {
        fs.mkdirSync(outputDir, { recursive: true });
    }

    fs.writeFileSync(OUTPUT_PATH, JSON.stringify(orgStructure, null, 2), 'utf8');

    console.log(`\n‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: ${employees.length} —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤`);
    console.log(`üìä –î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤: ${departments.size}`);
    console.log(`üìÅ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ: ${OUTPUT_PATH}\n`);

    console.log('=== –î–ï–ü–ê–†–¢–ê–ú–ï–ù–¢–´ ===');
    orgStructure.departments.forEach(dept => {
        const leaders = dept.leaders.length > 0
            ? ` | üë§ ${dept.leaders[0].name}`
            : '';
        console.log(`${dept.icon} ${dept.name}: ${dept.employeeCount} —á–µ–ª.${leaders}`);
    });
}

parseOrgStructure();
